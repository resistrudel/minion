function scrollToLink(e){var t=e.href,r=t.split("#");$("html,body").animate({scrollTop:$("#"+r[1]).offset().top},900)}function getQueryVariable(e){for(var t=window.location.search.substring(1),r=t.split("&"),i=0;i<r.length;i++){var n=r[i].split("=");if(n[0]===e)return n[1]}return!1}function derrickPresentAndLoggedIn(){var e=!1;return"undefined"!=typeof derrick&&derrick.Derrick.prototype.hasProfile()&&(e=!0),e}window.Modernizr=function(e,t,r){function i(e){m.cssText=e}function n(e,t){return i(prefixes.join(e+";")+(t||""))}function o(e,t){return typeof e===t}function s(e,t){return!!~(""+e).indexOf(t)}function a(e,t){for(var i in e){var n=e[i];if(!s(n,"-")&&m[n]!==r)return"pfx"!=t||n}return!1}function l(e,t,i){for(var n in e){var s=t[e[n]];if(s!==r)return!1===i?e[n]:o(s,"function")?s.bind(i||t):s}return!1}function c(e,t,r){var i=e.charAt(0).toUpperCase()+e.slice(1),n=(e+" "+_.join(i+" ")+i).split(" ");return o(t,"string")||o(t,"undefined")?a(n,t):(n=(e+" "+w.join(i+" ")+i).split(" "),l(n,t,r))}var d="2.6.2",p={},f=t.documentElement,u="modernizr",h=t.createElement(u),m=h.style,v,y={}.toString,g="Webkit Moz O ms",_=g.split(" "),w=g.toLowerCase().split(" "),b={},k={},F={},E=[],x=E.slice,j,C={}.hasOwnProperty,D;D=o(C,"undefined")||o(C.call,"undefined")?function(e,t){return t in e&&o(e.constructor.prototype[t],"undefined")}:function(e,t){return C.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var r=x.call(arguments,1),i=function(){if(this instanceof i){var n=function(){};n.prototype=t.prototype;var o=new n,s=t.apply(o,r.concat(x.call(arguments)));return Object(s)===s?s:o}return t.apply(e,r.concat(x.call(arguments)))};return i}),b.csstransforms=function(){return!!c("transform")};for(var O in b)D(b,O)&&(j=O.toLowerCase(),p[j]=b[O](),E.push((p[j]?"":"no-")+j));return p.addTest=function(e,t){if("object"==typeof e)for(var i in e)D(e,i)&&p.addTest(i,e[i]);else{if(e=e.toLowerCase(),p[e]!==r)return p;t="function"==typeof t?t():t,"undefined"!=typeof enableClasses&&enableClasses&&(f.className+=" "+(t?"":"no-")+e),p[e]=t}return p},i(""),h=v=null,p._version=d,p._domPrefixes=w,p._cssomPrefixes=_,p.testProp=function(e){return a([e])},p.testAllProps=c,p}(this,this.document),function(e,t,r){function i(e){return"[object Function]"==h.call(e)}function n(e){return"string"==typeof e}function o(){}function s(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function a(){var e=m.shift();v=1,e?e.t?f(function(){("c"==e.t?C.injectCss:C.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),a()):v=0}function l(e,r,i,n,o,l,c){function d(t){if(!h&&s(p.readyState)&&(w.r=h=1,!v&&a(),p.onload=p.onreadystatechange=null,t)){"img"!=e&&f(function(){_.removeChild(p)},50);for(var i in E[r])E[r].hasOwnProperty(i)&&E[r][i].onload()}}var c=c||C.errorTimeout,p=t.createElement(e),h=0,y=0,w={t:i,s:r,e:o,a:l,x:c};1===E[r]&&(y=1,E[r]=[]),"object"==e?p.data=r:(p.src=r,p.type=e),p.width=p.height="0",p.onerror=p.onload=p.onreadystatechange=function(){d.call(this,y)},m.splice(n,0,w),"img"!=e&&(y||2===E[r]?(_.insertBefore(p,g?null:u),f(d,c)):E[r].push(p))}function c(e,t,r,i,o){return v=0,t=t||"j",n(e)?l("c"==t?b:w,e,t,this.i++,r,i,o):(m.splice(this.i++,0,e),1==m.length&&a()),this}function d(){var e=C;return e.loader={load:c,i:0},e}var p=t.documentElement,f=e.setTimeout,u=t.getElementsByTagName("script")[0],h={}.toString,m=[],v=0,y="MozAppearance"in p.style,g=y&&!!t.createRange().compareNode,_=g?p:u.parentNode,p=e.opera&&"[object Opera]"==h.call(e.opera),p=!!t.attachEvent&&!p,w=y?"object":p?"script":"img",b=p?"script":w,k=Array.isArray||function(e){return"[object Array]"==h.call(e)},F=[],E={},x={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}},j,C;C=function(e){function t(e){var e=e.split("!"),t=F.length,r=e.pop(),i=e.length,r={url:r,origUrl:r,prefixes:e},n,o,s;for(o=0;o<i;o++)s=e[o].split("="),(n=x[s.shift()])&&(r=n(r,s));for(o=0;o<t;o++)r=F[o](r);return r}function s(e,n,o,s,a){var l=t(e),c=l.autoCallback;l.url.split(".").pop().split("?").shift(),l.bypass||(n&&(n=i(n)?n:n[e]||n[s]||n[e.split("/").pop().split("?")[0]]),l.instead?l.instead(e,n,o,s,a):(E[l.url]?l.noexec=!0:E[l.url]=1,o.load(l.url,l.forceCSS||!l.forceJS&&"css"==l.url.split(".").pop().split("?").shift()?"c":r,l.noexec,l.attrs,l.timeout),(i(n)||i(c))&&o.load(function(){d(),n&&n(l.origUrl,a,s),c&&c(l.origUrl,a,s),E[l.url]=2})))}function a(e,t){function r(e,r){if(e){if(n(e))r||(c=function(){var e=[].slice.call(arguments);d.apply(this,e),p()}),s(e,c,t,0,a);else if(Object(e)===e)for(u in f=function(){var t=0,r;for(r in e)e.hasOwnProperty(r)&&t++;return t}(),e)e.hasOwnProperty(u)&&(!r&&!--f&&(i(c)?c=function(){var e=[].slice.call(arguments);d.apply(this,e),p()}:c[u]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),p()}}(d[u])),s(e[u],c,t,u,a))}else!r&&p()}var a=!!e.test,l=e.load||e.both,c=e.callback||o,d=c,p=e.complete||o,f,u;r(a?e.yep:e.nope,!!l),l&&r(l)}var l,c,p=this.yepnope.loader;if(n(e))s(e,0,p,0);else if(k(e))for(l=0;l<e.length;l++)c=e[l],n(c)?s(c,0,p,0):k(c)?C(c):Object(c)===c&&a(c,p);else Object(e)===e&&a(e,p)},C.addPrefix=function(e,t){x[e]=t},C.addFilter=function(e){F.push(e)},C.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",j=function(){t.removeEventListener("DOMContentLoaded",j,0),t.readyState="complete"},0)),e.yepnope=d(),e.yepnope.executeStack=a,e.yepnope.injectJs=function(e,r,i,n,l,c){var d=t.createElement("script"),p,h,n=n||C.errorTimeout;d.src=e;for(h in i)d.setAttribute(h,i[h]);r=c?a:r||o,d.onreadystatechange=d.onload=function(){!p&&s(d.readyState)&&(p=1,r(),d.onload=d.onreadystatechange=null)},f(function(){p||(p=1,r(1))},n),l?d.onload():u.parentNode.insertBefore(d,u)},e.yepnope.injectCss=function(e,r,i,n,s,l){var n=t.createElement("link"),c,r=l?a:r||o;n.href=e,n.rel="stylesheet",n.type="text/css";for(c in i)n.setAttribute(c,i[c]);s||(u.parentNode.insertBefore(n,u),f(r,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},$(".no-js").removeClass("no-js").addClass("js"),$("body").find("a.scroll").click(function(e){e.preventDefault(),scrollToLink(this)}),$(document).ready(function(){var e=$(".items-container .item").first();e.addClass("active");var t=0,r=0,i=quizAnswers.length;$(".item button").click(function(){t++;var n=$(this),o=1*e.attr("data-index"),s=e.find("button"),a=s.index(n);s.each(function(){$(this)!=n&&$(this).attr("disabled","disabled")}),a===quizAnswers[o]?(n.addClass("correct"),r++):n.addClass("incorrect"),setTimeout(function(){e.slideUp(),t<i?$nextItem=$(".item[data-index="+(o+1)+"]"):($(".results #score").text(r),$(".results #total").text(i),$nextItem=$(".results"),$(".quiz-intro").slideUp()),$nextItem.slideDown(),e=$nextItem},1500),$("#restart").click(function(){e=$(".items-container .item").first(),$(".results").slideUp(),e.slideDown(),$(".item button").removeClass("correct incorrect").removeAttr("disabled"),t=0,r=0}),$("#enter").click(function(){$(".quiz .wrapper .quiz-container").slideUp(),$(".question").fadeIn(),$(".form-wrapper").fadeIn()})}),$(".answers-container ul li").on("click",function(){console.log($(this));var e=$(this);e.addClass("clicked"),e.siblings().removeClass("clicked"),$("html, body").animate({scrollTop:$(".form-wrapper").offset().top},2e3)})}),function(){function e(e,t,r){this.$form=e,this.$form_wrapper=t||$("body").find("#form-wrapper"),this.$form_container=r||this.$form_wrapper.find("#form-container"),this.$userDetails=this.$form_container.find("#user-details"),this.$questionSection=this.$form_container.find("#question"),this.$inputs=this.$form.find("input"),this.errors=[],this.formID=this.$form.find("#formID").val(),this.$answerLengthFields=this.$form.find(".answer-length")||!1,this.derrickFailed=!1,this._attachEvents(),this.$form.prepend('<input type="hidden" id="js" name="js" value="1" />'),this._addJS()}function t(t,r,i){var n=new e(t,r,i);"function"!=typeof derrickInstance&&(n.derrickFailed=!0),window.competitionForm=n}e.prototype._attachEvents=function(){if(this.$form.on("submit",this._onSubmit.bind(this)),this.$userDetails.on("change","input[type=checkbox], input[type=radio]",this._checkValRemoveError.bind(this)),this.$questionSection.on("change","input[type=checkbox], input[type=radio]",this._checkValRemoveError.bind(this)),this.$questionSection.on("keyup","input, textarea",this._checkValRemoveError.bind(this)),this.$userDetails.on("keyup","input, textarea",this._checkValRemoveError.bind(this)),this.$answerLengthFields){var e=this;this.$answerLengthFields.each(function(){e._initAnswerLength(this)})}},e.prototype._checkValRemoveError=function(e){var t=this.$form.find("#"+e.target.id);t.val().length>0&&this._removeError(t)},e.prototype._onSubmit=function(e){if(derrickPresentAndLoggedIn()||this.derrickFailed){e.preventDefault();var t=this;$.ajax({type:"POST",url:"includes/form.validator.php",data:this.$form.serialize(),cache:!1,success:function(e){e.length&&t._checkForm(e)}})}},e.prototype._checkForm=function(e){return e=JSON.parse(e),!0===e.submitted?void this._showThankYou():!0===e.fileupload?(this.$form.find("input#js").remove(),void this.$form.submit()):(this._addJS(),this._resetPHP(),this.errors=e,void this._showErrors())},e.prototype._showThankYou=function(){var e=getQueryVariable("preview"),t=this;this.$form_wrapper.width(this.$form_wrapper.outerWidth()).height(this.$form_wrapper.outerHeight()),this.$form_wrapper.append('<div id="result" class="result" />');var r=this.$form_wrapper.find("#result");r.hide(),r.load("includes/templ.success.php?formID="+this.formID+(e?"&preview="+e:""),function(){t.$form_container.fadeOut(1200,function(){$(this).remove(),t.$form_wrapper.addClass("thank-you"),r.fadeIn(1200),$("html, body").animate({scrollTop:t.$form_wrapper.offset().top-70},900)})})},e.prototype._addJS=function(){var e=$("input[name="+j_+"]"),t=this.$inputs.length-1,r=Math.floor(Math.random()*t),i=this.$form.find("input:eq("+r+")");e.length&&e.remove(),$.ajax({type:"GET",url:"includes/inc.js.php",cache:!1,data:{formID:this.formID},success:function(e){e.length&&$('<input type="hidden" name="'+j_+'" value="'+e+'" />').insertBefore(i)}})},e.prototype._resetPHP=function(){$.ajax({type:"GET",url:"includes/inc.reset.php",cache:!1,data:{formID:this.formID},success:function(e){e.length&&$("input[name="+t_+"]").val(e)}})},e.prototype.populateForm=function(e){var t=e.dob.split("-"),r=t[2],i=t[1],n=t[0],o=r>0&&i>0&&n>1900,s="M"===e.gender?"M-Mr":"F-Ms";this._populateAndReplaceField("firstName",e.first_name),this._populateAndReplaceField("surname",e.last_name),this._populateAndReplaceField("email",e.email),this._populateAndReplaceField("postCode",e.postcode),this._populateAndReplaceField("phone",e.phone),this._populateAndReplaceField("dateOfBirth_day",r),this._populateAndReplaceField("dateOfBirth_month",i),this._populateAndReplaceField("dateOfBirth_year",n),this._populateAndReplaceField("gender",s,"select"),e.global_comms&&(this.$form.find('input[name="stationOptIn"]').prop("checked",!0),this.$form.find('input[name="stationOptIn"], label[for="stationOptIn"]').hide()),o&&this.$userDetails.find("#field-container-dateOfBirth").hide()},e.prototype._populateAndReplaceField=function(e,t,r){if(t.length){var i=e+"_inactive",n=e+"_dummy",o="#field-container-"+e,s=this.$userDetails.find('*[name="'+e+'"]');s.hide().attr({name:i,disabled:!0}),$("#"+n).length||($('<span class="dummy" id="'+e+'_dummy">'+t+"</span>").insertBefore(s),$('<input type="hidden" id="'+e+'_substitute" value="'+t+'" name="'+e+'"/>').insertBefore(s)),this.$userDetails.find(o).hide()}},e.prototype._resetField=function(e){var t=this.$userDetails.find("#"+e+"_substitute"),r="#field-container-"+e;t.length?(t.remove(),this.$userDetails.find("#"+e+"_dummy").remove(),this.$userDetails.find('*[name="'+e+'_inactive"]').show().attr({name:e,disabled:!1}),this.$userDetails.find(r).show()):this.$userDetails.find('*[name="'+e+'"]').val("")},e.prototype.clearForm=function(){this._resetField("firstName"),this._resetField("surname"),this._resetField("email"),this._resetField("postCode"),this._resetField("phone"),this._resetField("dateOfBirth_day"),this._resetField("dateOfBirth_month"),this._resetField("dateOfBirth_year"),this._resetField("gender"),this.$userDetails.find("#field-container-dateOfBirth").show()},e.prototype.authenticated=function(e){this.$userDetails.show(),this.populateForm(e),this._triggerSC(e)},e.prototype.notAuthenticated=function(){this.$userDetails.hide(),this.clearForm()},e.prototype.setDerrickFlag=function(e){this.derrickFailed=!1!==e},e.prototype._showErrors=function(){for(var e in this.errors)this.errors.hasOwnProperty(e)&&this.showError(e,this.errors[e]);$("html,body").animate({scrollTop:$(".error").first().offset().top},900)},e.prototype._getErrorElement=function(e){var t=this.$form.find('label[for="'+e+'"]');return t.length||(t=this.$form.find("#"+e)),!!t.length&&t},e.prototype.showError=function(e,t){void 0===t&&(t=this.errors[e]);var r=this._getErrorElement(e);if(!r.length&&"general"!==e)return void console.log("WARNING: can't find parent for "+e);if(2===this.errors.length&&"general"===e&&(this.$form[0].reset(),this._resetPHP()),this.$form.find(".error."+e).length){if(this.$form.find(".error."+e).html()===t)return;this.$form.find(".error."+e).hide("normal").remove()}if("general"===e)return this.$form.find("fieldset").first().prepend('<p class="error '+e+'">'+t+"</p>"),void $("p."+e).hide().show("slow");r.closest(".nested").length&&(r=r.closest(".nested").parent());var i=r.get(0).nodeName.toLowerCase(),n=r.parent(),o=n.get(0).nodeName.toLowerCase(),s=i,a=r;switch(i){case"label":s=o,a=n;break;case"input":"dd"===o&&(o="dt"),s=o,a=n;break;case"dd":r.prev().is("dt")&&(r=r.prev(),s="dt");break;case"ul":case"p":case"dt":case"li":break}var l=document.createElement(s);l.className="error "+e,l.innerHTML=t,$(l).insertBefore(a).hide().show("slow")},e.prototype._removeError=function(e){var t,r=e.attr("id");e.is(":radio")&&(r=e.attr("name")),r.split("_").length>1&&(r=r.split("_")[0]),t=".error."+r,"stationOptIn"!==r&&"clientOptIn"!==r||(t=".error.email, .error.postCode"),this.$form.find(t).hide("normal",function(){$(this).remove()})},e.prototype.removeAllErrors=function(){this.$form.find(".error").hide("normal",function(){$(this).remove()})},e.prototype._initAnswerLength=function(e){var t=$(e),r=$("#"+t.data("target")),i=parseInt(t.find("span").text()),n="words"===t.attr("data-type")?"words":"characters";t.html("<span></span> "+n+" left"),0===r.val().length&&t.find("span").text(i),r.keyup(function(){var e="characters"===n?$(this).val().length:r.val().trim().replace(/\s+/gi," ").split(" ").length,o=i-e,s="";o<0?s="less-than-0":o<30&&(s="less-than-30"),t.addClass(s).find("span").text(o),r.addClass(s).find("span").text(o)})},e.prototype._triggerSC=function(e){var t=[],r="",i=e?"signed_in":"not_signed_in",n="",o=e?e.id:"not_signed_in",a=["prop18","prop46","eVar18","eVar20","prop20","eVar50","events"];if(e.login_event){switch(e.login_event){case"emailRegister":t.push("event3","event9"),r="register";break;case"emailSignIn":t.push("event9"),r="sign_in";break;case"socialSignIn":t.push("event9"),r="sign_in";break}n="MKT:EXT:"+r}s.prop18=i,s.eVar18=i,s.prop46=o,s.eVar50=o,s.eVar20=n,s.eProp20=n,s.events=t.join(","),s.linkTrackVars=a.join(","),s.linkTrackEvents=t.join(","),s.tl(!0,"o","Commercial Microsite")},window.initForm=t}();